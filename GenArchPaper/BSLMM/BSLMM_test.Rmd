---
title: "BSLMM test"
author: "Heather E. Wheeler"
date: "June 10, 2015"
output: html_document
---
```{r}
"%&%" = function(a,b) paste(a,b,sep="")
library(ggplot2)
library(dplyr)
library(tidyr)
##test gene is SEZ6L, pull GCTA h2 estimates:
my.dir <- '/Volumes/im-lab/nas40t2/hwheeler/cross-tissue/'
otherfile<-my.dir %&% 'expArch_DGN-WB_imputedGTs/DGN-WB.h2.all.models_FHSfdr0.05.all.Chr1-22_globalOtherChr.2015-03-18.txt'
fdrother<-read.table(otherfile,header=T) ##FHS eQTLs w/fdr<0.05 on non-gene chromosomes used to define global GRM
filter(fdrother,gene=='SEZ6L')

##BSLMM results for SEZ6L
file<-'/Volumes/im-lab/nas40t2/hwheeler/cross-tissue/BSLMM_exp/output/test.hyp.txt'
b<-read.table(file,header=T)
head(b)
dim(b)
colMeans(b)
apply(b,2,sd)
ggplot(b,aes(x=1:length(b$pve),y=pve)) + geom_point() + coord_cartesian(ylim=c(0,1)) + xlab('10nth iteration') + geom_point(aes(x=1:length(b$pge),y=b$pge,color='pge'))

data<-gather(b,component,proportion,-h,-rho,-pi,-n_gamma)
ggplot(data,aes(x=component,y=proportion)) + geom_boxplot()
```